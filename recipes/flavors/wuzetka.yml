---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: wuzetka
description: sneexy's personal and opinionated kinoite image

# the base image to build on top of (FROM) and the version tag to use
base-image: ghcr.io/ublue-os/kinoite-main
image-version: latest # latest is also supported if you want new updates ASAP

# module configuration, executed in order
# you can include multiple instances of the same module
modules:
  - type: bling
    install:
      - dconf-update-service

  - from-file: common/dnf.yml
  - from-file: common/wuzetka/dnf.yml
  - from-file: common/mpd.yml

  # copy files and software from helper images
  - type: containerfile
    snippets:
      - COPY --from=ghcr.io/snenxytengoku/wuzetka-helper /artifacts/usr /usr
      - COPY --from=ghcr.io/snenxytengoku/wuzetka-helper /artifacts/etc /etc

  - type: script
    scripts:
      # are these even required anymore lol
      - ld.sh
      - qdbus.sh
      - firmware-finalize.sh
      # customization
      - sddm-astronaut-theme.sh
      - posy-cursors.sh
      - papirus.sh
      # catppuccin
      - catppuccin/plasma.sh
      - catppuccin/papirus.sh
      # fixes
      - vscodium.sh
      - lazyvim.sh
      # various additions
      - flac2opus.sh
      - just.sh
      # ---
      - flavor/wuzetka.sh

  # shared base filesystem
  - type: files
    files:
      - source: system/base
        destination: /

  # wuzetka files
  - type: files
    files:
      - source: system/wuzetka
        destination: /

  - from-file: common/flatpaks.yml
  - from-file: common/fonts.yml

  - type: systemd
    system:
      enabled:
        - tailscaled.service
        - libvirtd.service
        - dnsmasq.service
    user:
      enabled:
        - mpd.service
        - mpdris2-rs.service
        - music-discord-rpc.service
        - rescrobbled.service
        - systemd-tmpfiles-setup.service

  - type: gschema-overrides
    include:
      - zz1-wuzetka.gschema.override

  - type: signing