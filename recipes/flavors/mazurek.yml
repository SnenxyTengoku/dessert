---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: mazurek
description: sneexy's personal and opinionated fedora niri image

# the base image to build on top of (FROM) and the version tag to use
base-image: ghcr.io/wayblueorg/niri
image-version: 43 # latest is also supported if you want new updates ASAP

modules:
  - type: containerfile
    snippets:
      # wayblue nukes "unused" repositories in their images; this breaks trying to install packages from rpmfusion. ðŸ«©
      # (NOTE: really, all we need is fedora-cisco-openh264, but that would also mean needing to keep it manually up to date and etc. so we just pull it all back in)
      - COPY --from=quay.io/fedora-ostree-desktops/base-atomic:43 /etc/yum.repos.d /etc/yum.repos.d

  # packages
  - from-file: packages/dnf.yml # base package selection
  - from-file: packages/flatpaks.yml # base default flatpaks
  - from-file: packages/mazurek/dnf.yml # mazurek package selection
  - from-file: packages/mazurek/flatpaks.yml # mazurek flatpak flatpaks
  - from-file: kernels/bazzite.yml # bazzite kernel

  # pre-run
  - from-file: shared/files.yml # shared base filesystem
  - from-file: shared/scripts.yml # default scripts selection

  # mazurek files
  #- type: files
  #  files:
  #    - source: system/mazurek
  #      destination: /

  # copy files and software from helper images
  - type: containerfile
    snippets:
      # -- cargo
      - COPY --from=ghcr.io/snenxytengoku/helper-cargo /artifacts/usr /usr
      # -- go
      - COPY --from=ghcr.io/snenxytengoku/helper-go /artifacts/usr /usr

  - type: script
    scripts:
      # customization
      - additions/sddm-astronaut-theme.sh
      # ---
      - flavors/mazurek.sh

  # post-run
  - from-file: shared/fonts.yml # fonts
  - from-file: shared/bling.yml # ublue bling selection
  - from-file: shared/systemd.yml # default systemd services

  #- type: gschema-overrides
  #  include:
  #    - zz1-wuzetka.gschema.override

  - type: signing